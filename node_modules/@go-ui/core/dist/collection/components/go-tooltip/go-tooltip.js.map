{"version":3,"file":"go-tooltip.js","sourceRoot":"","sources":["../../../src/components/go-tooltip/go-tooltip.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Element, Prop, State, Method } from '@stencil/core';\nimport { uniqueId, debounce } from 'lodash-es';\nimport { computePosition, flip, shift, arrow, offset, autoUpdate, inline } from '@floating-ui/dom';\n\n@Component({\n  tag: 'go-tooltip',\n  styleUrl: 'go-tooltip.scss',\n  shadow: false,\n})\nexport class GoTooltip {\n  @Element() el: HTMLElement;\n\n  /**\n   * Query selector string for the trigger element\n   */\n  @Prop() triggerId: string;\n\n  /**\n   * Add arrow to the tooltip\n   */\n  @Prop() arrow: boolean = false;\n\n  /**\n   * Improve positioning for inline trigger elements that span over multiple lines.\n   * Reference: https://floating-ui.com/docs/inline\n   */\n  @Prop() inline: boolean = false;\n\n  /**\n   * placement of tooltip relative to the trigger element\n   */\n  @Prop() placement: 'top' | 'bottom' | 'left' | 'right' = 'top';\n\n  private triggerEl: HTMLElement;\n  private arrowEl: HTMLElement;\n\n  componentWillLoad() {\n    // if id attribute is not provided, generate a unique id for the tooltip\n    if (!this.el.id) {\n      this.el.id = uniqueId('go-tooltip-');\n    }\n    this.triggerEl = document.querySelector(`#${this.triggerId}`) as HTMLElement;\n  }\n\n  private cleanUpAutoUpdate;\n\n  componentDidLoad() {\n    if (!this.triggerEl) {\n      return;\n    }\n\n    this.triggerEl.setAttribute('aria-describedby', this.el.id);\n    // add event handlers to triggerEl\n    this.triggerEl.addEventListener('mouseenter', () => this.show());\n    document.addEventListener('mousemove', (e) => this.debouncedDetermineMouseOut(e));\n    this.triggerEl.addEventListener('focusin', () => this.show());\n    this.triggerEl.addEventListener('focusout', () => this.hide());\n\n    this.arrowEl = this.el.querySelector('.tooltip-tail') as HTMLElement;\n    this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl);\n    // keep watching for changes to the tooltip position\n    this.cleanUpAutoUpdate = autoUpdate(\n      this.triggerEl,\n      this.el,\n      debounce(() => this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl), 300),\n      { animationFrame: true },\n    );\n\n    // press esc to hide tooltip\n    document.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  initialiseTooltip(triggerEl, tooltipEl, arrowEl) {\n    let middleware = [offset(8), flip(), shift()];\n    if (this.arrow) {\n      middleware.push(arrow({ element: arrowEl }));\n    }\n\n    if (this.inline) {\n      middleware.push(inline());\n    }\n    computePosition(triggerEl, tooltipEl, {\n      strategy: 'fixed',\n      placement: this.placement,\n      middleware,\n    }).then(({ x, y, placement, middlewareData }) => {\n      Object.assign(this.el.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      });\n      if (this.arrow) {\n        // Accessing the data\n        const { x: arrowX, y: arrowY } = middlewareData.arrow;\n\n        const staticSide = {\n          top: 'bottom',\n          right: 'left',\n          bottom: 'top',\n          left: 'right',\n        }[placement.split('-')[0]];\n\n        Object.assign(arrowEl.style, {\n          left: arrowX != null ? `${arrowX}px` : '',\n          top: arrowY != null ? `${arrowY}px` : '',\n          right: '',\n          bottom: '',\n          [staticSide]: '-3px',\n        });\n      }\n    });\n  }\n\n  @State() isActive: boolean = false;\n\n  /**\n   * show tooltip\n   */\n  @Method()\n  async show() {\n    this.isActive = true;\n  }\n\n  /**\n   * hide tooltip\n   */\n  @Method()\n  async hide() {\n    this.isActive = false;\n  }\n  debouncedDetermineMouseOut = debounce(this.determineMouseOut, 150);\n  determineMouseOut(e: MouseEvent) {\n    if (!this.isActive) {\n      return;\n    }\n    // check if mouse is outside of the tooltip and the trigger element\n    const { x, y } = e;\n    const { left, top, right, bottom } = this.el.getBoundingClientRect();\n    const { left: triggerLeft, top: triggerTop, right: triggerRight, bottom: triggerBottom } = this.triggerEl.getBoundingClientRect();\n    const isOutside = x < left || x > right || y < top || y > bottom;\n    const isOutsideTrigger = x < triggerLeft || x > triggerRight || y < triggerTop || y > triggerBottom;\n    if (isOutside && isOutsideTrigger) {\n      this.hide();\n    }\n  }\n\n  disconnectedCallback() {\n    this.cleanUpAutoUpdate && this.cleanUpAutoUpdate();\n  }\n\n  render() {\n    const { isActive, arrow } = this;\n\n    return (\n      <Host role=\"tooltip\" class={{ 'is-active': isActive }} aria-hidden={isActive ? 'false' : 'true'}>\n        <slot></slot>\n        {arrow ? <div class=\"tooltip-tail\"></div> : null}\n      </Host>\n    );\n  }\n}\n"]}