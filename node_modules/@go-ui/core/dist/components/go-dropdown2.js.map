{"file":"go-dropdown2.js","mappings":";;;;;;AAAA,MAAM,aAAa,GAAG,m7BAAm7B,CAAC;AAC18B,yBAAe,aAAa;;MCSf,UAAU;;;;;;;wBAUuC,KAAK;qBAKhD,MAAM;qCAKS,KAAK;yBAKhB,KAAK;wBAKN,KAAK;;;;;IAczB,MAAM,IAAI;QACR,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO;SACR;QACD,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAA4B,CAAC;QACtD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;KACpB;;;;IAUD,MAAM,KAAK,CAAC,kBAAkB,GAAG,KAAK;QACpC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QACnB,IAAI,IAAI,CAAC,QAAQ,IAAI,kBAAkB,EAAE;YACvC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SACvB;KACF;;;;IAMD,MAAM,MAAM;QACV,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;aAAM;YACL,IAAI,CAAC,IAAI,EAAE,CAAC;SACb;KACF;IAQD,iBAAiB;;QAEf,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YACf,IAAI,CAAC,EAAE,CAAC,EAAE,GAAG,QAAQ,CAAC,cAAc,CAAC,CAAC;SACvC;QACD,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,eAAe,EAAE,CAAgB,CAAC;KACnF;IAMD,MAAM,gBAAgB;QACpB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,OAAO;SACR;QACD,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;;QAGlB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;YACrB,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,EAAE;gBACvB,IAAI,CAAC,KAAK,EAAE,CAAC;aACd;SACF,CAAC;QACF,IAAI,CAAC,eAAe,GAAG,CAAC,CAAa;YACnC,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,aAAqB,CAAC,EAAE;gBACpD,OAAO;aACR;YACD,IAAI,CAAC,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,aAAqB,CAAC,EAAE;gBACjE,IAAI,CAAC,KAAK,EAAE,CAAC;aACd;SACF,CAAC;QACF,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;;QAEzD,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;KAC5D;IAED,oBAAoB;QAClB,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;SAC7D;QACD,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,UAAU,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;SAC/D;QACD,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC5B,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QACD,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,iBAAiB,EAAE,CAAC;SAC1B;KACF;IAGD,MAAM,IAAI;QACR,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;QACrD,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;QAGvC,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;YAC/B,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;SAC/D;QAED,IAAI,CAAC,mBAAmB,GAAG,cAAc,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;YACnD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAc,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE;gBAC/D,IAAI,CAAC,KAAK,EAAE,CAAC;aACd;SACF,CAAC,CAAC;;;;QAIH,MAAM,UAAU,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CACjC,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,EAAE,EACP,QAAQ,CAAC;YACP,eAAe,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;gBACvC,QAAQ,EAAE,OAAO;gBACjB,SAAS,EAAE,cAAc;gBACzB,UAAU;aACX,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,cAAc,EAAE;;gBAC/B,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE;oBAC3B,IAAI,EAAE,GAAG,CAAC,IAAI;oBACd,GAAG,EAAE,GAAG,CAAC,IAAI;iBACd,CAAC,CAAC;gBACH,IAAI,CAAA,MAAA,MAAA,cAAc,CAAC,IAAI,0CAAE,SAAS,0CAAE,MAAM,IAAG,CAAC,EAAE;oBAC9C,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;iBAC/B;qBAAM;oBACL,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iBAClC;aACF,CAAC,CAAC;SACJ,EAAE,EAAE,CAAC,CACP,CAAC;KACH;IAED,kBAAkB,CAAC,QAAiB;QAClC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,eAAe,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;KAChE;IAGD,kBAAkB,CAAC,QAAQ;QACzB,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;QAClC,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;;SAEjC;aAAM;YACL,IAAI,CAAC,EAAE,CAAC,gBAAgB,CACtB,eAAe,EACf;gBACE,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;aAChC,EACD,EAAE,IAAI,EAAE,IAAI,EAAE,CACf,CAAC;YACF,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;SACxB;KACF;IAED,MAAM;QACJ,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC;QAC1C,QACE,EAAC,IAAI,qDACH,KAAK,EAAE,EAAE,WAAW,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE,iBAC5C,QAAQ,GAAG,OAAO,GAAG,MAAM,EACxC,KAAK,EAAE,EAAE,kBAAkB,EAAE,KAAK,EAAE,IACpC,4DAAK,KAAK,EAAC,kBAAkB,IAC3B,8DAAa,CACT,CACD,EACP;KACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["src/components/go-dropdown/go-dropdown.scss?tag=go-dropdown","src/components/go-dropdown/go-dropdown.tsx"],"sourcesContent":["go-dropdown {\n  /**\n    @prop --dropdown-shadow:\n      Box shadow of dropdown\n      - default: var(--shadow-3)\n  */\n  --dropdown-shadow: var(--shadow-3);\n  /**\n    @prop --dropdown-bg-color:\n      Dropdown background color\n      - default: var(--go-color-lightest)\n  */\n  --dropdown-bg-color: var(--go-color-lightest);\n\n  /**\n    @prop --dropdown-duration:\n      Duration for dropdown open/close transition\n      - default: var(--go-duration-fast)\n  */\n  --dropdown-duration: var(--go-duration-fast);\n\n  /**\n    @prop --dropdown-radius:\n      Border radius of dropdown\n      - default: var(--radius-2)\n  */\n  --dropdown-radius: var(--radius-2);\n\n  position: fixed;\n  display: none;\n  visibility: hidden;\n  opacity: 0;\n  box-shadow: var(--dropdown-shadow);\n  pointer-events: none;\n  z-index: 1;\n  transform: translateY(-5px);\n  transform-origin: top;\n  width: var(--dropdown-width, 200px);\n  background-color: var(--dropdown-bg-color);\n  border-radius: var(--dropdown-radius);\n  @include transition(opacity var(--dropdown-duration), visibility, transform var(--dropdown-duration));\n  &.full-width {\n    --dropdown-width: 100%;\n  }\n  &.flip {\n    transform-origin: bottom;\n    transform: translateY(5px);\n  }\n\n  &.is-active {\n    visibility: visible;\n    opacity: 1;\n    pointer-events: inherit;\n    transform: translateY(0);\n  }\n}\n","import { Component, Host, h, Element, Prop, Method, Watch, Event, EventEmitter } from '@stencil/core';\nimport { uniqueId, debounce } from 'lodash-es';\nimport { computePosition, offset, flip, autoUpdate } from '@floating-ui/dom';\nimport { onClickOutside } from '../../utils';\n\n@Component({\n  tag: 'go-dropdown',\n  styleUrl: 'go-dropdown.scss',\n  shadow: false,\n})\nexport class GoDropdown {\n  @Element() el: HTMLElement;\n  /**\n   * Query selector string for the trigger element.\n   */\n  @Prop() triggerSelector: string;\n\n  /**\n   * keep track of active state\n   */\n  @Prop({ reflect: true, mutable: true }) isActive: boolean = false;\n\n  /**\n   * Width of the dropdown, any CSS width values can be used.\n   */\n  @Prop() width? = 'auto';\n\n  /**\n   * If set, trigger click event will need to be handled manually.\n   */\n  @Prop() noTriggerClickHandler = false;\n\n  /**\n   * If set, dropdown will take full width of its parent.\n   */\n  @Prop() fullWidth? = false;\n\n  /**\n   * if set, dropdown cannot be opened\n   */\n  @Prop() disabled? = false;\n\n  /**\n   * Emitted when dropdown is opened\n   */\n  @Event() opened: EventEmitter<void>;\n\n  // keep track of where the focus was before the dropdown opens\n  originEl: HTMLElement;\n\n  /**\n   * opens dropdown\n   */\n  @Method()\n  async open() {\n    if (this.disabled) {\n      return;\n    }\n    this.originEl = document.activeElement as HTMLElement;\n    this.isActive = true;\n    this.opened.emit();\n  }\n  /**\n   * Emitted when dropdown is opened\n   */\n  @Event() closed: EventEmitter<void>;\n\n  /**\n   * closes dropdown\n   */\n  @Method()\n  async close(focusBackToTrigger = false) {\n    this.isActive = false;\n    this.closed.emit();\n    if (this.originEl && focusBackToTrigger) {\n      this.originEl.focus();\n    }\n  }\n\n  /**\n   * toggles dropdown\n   */\n  @Method()\n  async toggle() {\n    if (this.isActive) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  private triggerEl: HTMLElement;\n\n  // reference to clean up function to autoupdate\n  // see https://floating-ui.com/docs/autoupdate\n  private cleanupAutoUpdate: () => void;\n\n  componentWillLoad() {\n    // if id attribute is not provided, generate a unique id for the dropdown\n    if (!this.el.id) {\n      this.el.id = uniqueId('go-dropdown-');\n    }\n    this.triggerEl = document.querySelector(`${this.triggerSelector}`) as HTMLElement;\n  }\n\n  private escapeHandler;\n  private focusOutHandler;\n  private clickOutsideCleanUp;\n\n  async componentDidLoad() {\n    if (!this.triggerEl) {\n      return;\n    }\n    await this.init();\n\n    // press esc to close dropdown\n    this.escapeHandler = (e) => {\n      if (e.code === 'Escape') {\n        this.close();\n      }\n    };\n    this.focusOutHandler = (e: FocusEvent) => {\n      if (this.triggerEl.contains(e.relatedTarget as Node)) {\n        return;\n      }\n      if (e.relatedTarget && !this.el.contains(e.relatedTarget as Node)) {\n        this.close();\n      }\n    };\n    document.addEventListener('keydown', this.escapeHandler);\n    // focus outside to close dropdown\n    this.el.addEventListener('focusout', this.focusOutHandler);\n  }\n\n  disconnectedCallback() {\n    if (this.escapeHandler) {\n      document.removeEventListener('keydown', this.escapeHandler);\n    }\n    if (this.focusOutHandler) {\n      this.el.removeEventListener('focusout', this.focusOutHandler);\n    }\n    if (this.clickOutsideCleanUp) {\n      this.clickOutsideCleanUp();\n    }\n    if (this.cleanupAutoUpdate) {\n      this.cleanupAutoUpdate();\n    }\n  }\n\n  @Method()\n  async init() {\n    this.triggerEl.setAttribute('aria-haspopup', 'true');\n    this.setTriggerExpanded(this.isActive);\n\n    // add click event listener\n    if (!this.noTriggerClickHandler) {\n      this.triggerEl.addEventListener('click', () => this.toggle());\n    }\n\n    this.clickOutsideCleanUp = onClickOutside(this.el, (e) => {\n      if (!this.triggerEl.contains(e.target as Node) && this.isActive) {\n        this.close();\n      }\n    });\n    /**\n     * Calculate position of dropdown\n     */\n    const middleware = [offset(4), flip()];\n    this.cleanupAutoUpdate = autoUpdate(\n      this.triggerEl,\n      this.el,\n      debounce(() => {\n        computePosition(this.triggerEl, this.el, {\n          strategy: 'fixed',\n          placement: 'bottom-start',\n          middleware,\n        }).then(({ x, y, middlewareData }) => {\n          Object.assign(this.el.style, {\n            left: `${x}px`,\n            top: `${y}px`,\n          });\n          if (middlewareData.flip?.overflows?.length > 0) {\n            this.el.classList.add('flip');\n          } else {\n            this.el.classList.remove('flip');\n          }\n        });\n      }, 50),\n    );\n  }\n\n  setTriggerExpanded(expanded: boolean) {\n    this.triggerEl.setAttribute('aria-expanded', String(expanded));\n  }\n\n  @Watch('isActive')\n  handleActiveChange(isActive) {\n    this.setTriggerExpanded(isActive);\n    if (isActive) {\n      this.el.style.display = 'block';\n      // focusFirstWithin(this.el);\n    } else {\n      this.el.addEventListener(\n        'transitionend',\n        () => {\n          this.el.style.display = 'none';\n        },\n        { once: true },\n      );\n      this.triggerEl.focus();\n    }\n  }\n\n  render() {\n    let { isActive, width, fullWidth } = this;\n    return (\n      <Host\n        class={{ 'is-active': isActive, 'full-width': fullWidth }}\n        aria-hidden={isActive ? 'false' : 'true'}\n        style={{ '--dropdown-width': width }}>\n        <div class=\"dropdown-content\">\n          <slot></slot>\n        </div>\n      </Host>\n    );\n  }\n}\n"],"version":3}