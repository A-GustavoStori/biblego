{"version":3,"names":["goTooltipCss","GoTooltipStyle0","GoTooltip","this","debouncedDetermineMouseOut","debounce","determineMouseOut","componentWillLoad","el","id","uniqueId","triggerEl","document","querySelector","triggerId","componentDidLoad","setAttribute","addEventListener","show","e","hide","arrowEl","initialiseTooltip","cleanUpAutoUpdate","autoUpdate","animationFrame","key","tooltipEl","middleware","offset","flip","shift","arrow","push","element","inline","computePosition","strategy","placement","then","x","y","middlewareData","Object","assign","style","left","top","arrowX","arrowY","staticSide","right","bottom","split","isActive","getBoundingClientRect","triggerLeft","triggerTop","triggerRight","triggerBottom","isOutside","isOutsideTrigger","disconnectedCallback","render","h","Host","role","class"],"sources":["src/components/go-tooltip/go-tooltip.scss?tag=go-tooltip","src/components/go-tooltip/go-tooltip.tsx"],"sourcesContent":["go-tooltip {\n  /**\n    @prop --tooltip-bg-color:\n      Background color of the tooltip.\n      - default: var(--go-color-primary-800)\n  */\n  --tooltip-bg-color: var(--go-color-primary-800);\n\n  /**\n    @prop --tooltip-fg-color:\n      Text color of the tooltip.\n      - default: var(--go-color-lightest)\n  */\n  --tooltip-fg-color: var(--go-color-lightest);\n\n  /**\n    @prop --tooltip-padding:\n      Padding around tooltip\n      - default: 0.5rem\n  */\n  --tooltip-padding: 0.5rem;\n\n  /**\n    @prop --tooltip-radius:\n      Border radius of tooltip\n      - default: var(--radius-2)\n  */\n  --tooltip-radius: var(--radius-2);\n\n  @include transition(opacity, visibility);\n\n  position: fixed;\n  display: block;\n  visibility: hidden;\n  opacity: 0;\n  background-color: var(--tooltip-bg-color);\n  color: var(--tooltip-fg-color);\n  padding: var(--tooltip-padding);\n  border-radius: var(--tooltip-radius);\n  box-shadow: var(--shadow-1);\n  pointer-events: none;\n  font-size: var(--go-size-0);\n  z-index: var(--layer-important);\n\n  &.is-active {\n    visibility: visible;\n    opacity: 1;\n    pointer-events: inherit;\n  }\n\n  .tooltip-tail {\n    position: absolute;\n    background: var(--tooltip-bg-color);\n    width: 6px;\n    height: 6px;\n    transform: rotate(45deg);\n  }\n}\n","import { Component, Host, h, Element, Prop, State, Method } from '@stencil/core';\nimport { uniqueId, debounce } from 'lodash-es';\nimport { computePosition, flip, shift, arrow, offset, autoUpdate, inline } from '@floating-ui/dom';\n\n@Component({\n  tag: 'go-tooltip',\n  styleUrl: 'go-tooltip.scss',\n  shadow: false,\n})\nexport class GoTooltip {\n  @Element() el: HTMLElement;\n\n  /**\n   * Query selector string for the trigger element\n   */\n  @Prop() triggerId: string;\n\n  /**\n   * Add arrow to the tooltip\n   */\n  @Prop() arrow: boolean = false;\n\n  /**\n   * Improve positioning for inline trigger elements that span over multiple lines.\n   * Reference: https://floating-ui.com/docs/inline\n   */\n  @Prop() inline: boolean = false;\n\n  /**\n   * placement of tooltip relative to the trigger element\n   */\n  @Prop() placement: 'top' | 'bottom' | 'left' | 'right' = 'top';\n\n  private triggerEl: HTMLElement;\n  private arrowEl: HTMLElement;\n\n  componentWillLoad() {\n    // if id attribute is not provided, generate a unique id for the tooltip\n    if (!this.el.id) {\n      this.el.id = uniqueId('go-tooltip-');\n    }\n    this.triggerEl = document.querySelector(`#${this.triggerId}`) as HTMLElement;\n  }\n\n  private cleanUpAutoUpdate;\n\n  componentDidLoad() {\n    if (!this.triggerEl) {\n      return;\n    }\n\n    this.triggerEl.setAttribute('aria-describedby', this.el.id);\n    // add event handlers to triggerEl\n    this.triggerEl.addEventListener('mouseenter', () => this.show());\n    document.addEventListener('mousemove', (e) => this.debouncedDetermineMouseOut(e));\n    this.triggerEl.addEventListener('focusin', () => this.show());\n    this.triggerEl.addEventListener('focusout', () => this.hide());\n\n    this.arrowEl = this.el.querySelector('.tooltip-tail') as HTMLElement;\n    this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl);\n    // keep watching for changes to the tooltip position\n    this.cleanUpAutoUpdate = autoUpdate(\n      this.triggerEl,\n      this.el,\n      debounce(() => this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl), 300),\n      { animationFrame: true },\n    );\n\n    // press esc to hide tooltip\n    document.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  initialiseTooltip(triggerEl, tooltipEl, arrowEl) {\n    let middleware = [offset(8), flip(), shift()];\n    if (this.arrow) {\n      middleware.push(arrow({ element: arrowEl }));\n    }\n\n    if (this.inline) {\n      middleware.push(inline());\n    }\n    computePosition(triggerEl, tooltipEl, {\n      strategy: 'fixed',\n      placement: this.placement,\n      middleware,\n    }).then(({ x, y, placement, middlewareData }) => {\n      Object.assign(this.el.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      });\n      if (this.arrow) {\n        // Accessing the data\n        const { x: arrowX, y: arrowY } = middlewareData.arrow;\n\n        const staticSide = {\n          top: 'bottom',\n          right: 'left',\n          bottom: 'top',\n          left: 'right',\n        }[placement.split('-')[0]];\n\n        Object.assign(arrowEl.style, {\n          left: arrowX != null ? `${arrowX}px` : '',\n          top: arrowY != null ? `${arrowY}px` : '',\n          right: '',\n          bottom: '',\n          [staticSide]: '-3px',\n        });\n      }\n    });\n  }\n\n  @State() isActive: boolean = false;\n\n  /**\n   * show tooltip\n   */\n  @Method()\n  async show() {\n    this.isActive = true;\n  }\n\n  /**\n   * hide tooltip\n   */\n  @Method()\n  async hide() {\n    this.isActive = false;\n  }\n  debouncedDetermineMouseOut = debounce(this.determineMouseOut, 150);\n  determineMouseOut(e: MouseEvent) {\n    if (!this.isActive) {\n      return;\n    }\n    // check if mouse is outside of the tooltip and the trigger element\n    const { x, y } = e;\n    const { left, top, right, bottom } = this.el.getBoundingClientRect();\n    const { left: triggerLeft, top: triggerTop, right: triggerRight, bottom: triggerBottom } = this.triggerEl.getBoundingClientRect();\n    const isOutside = x < left || x > right || y < top || y > bottom;\n    const isOutsideTrigger = x < triggerLeft || x > triggerRight || y < triggerTop || y > triggerBottom;\n    if (isOutside && isOutsideTrigger) {\n      this.hide();\n    }\n  }\n\n  disconnectedCallback() {\n    this.cleanUpAutoUpdate && this.cleanUpAutoUpdate();\n  }\n\n  render() {\n    const { isActive, arrow } = this;\n\n    return (\n      <Host role=\"tooltip\" class={{ 'is-active': isActive }} aria-hidden={isActive ? 'false' : 'true'}>\n        <slot></slot>\n        {arrow ? <div class=\"tooltip-tail\"></div> : null}\n      </Host>\n    );\n  }\n}\n"],"mappings":"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"}