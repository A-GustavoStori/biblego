{"version":3,"names":["goDropdownMenuCss","GoDropdownMenuStyle0","GoDropdownMenu","this","focusedMenuItemIndex","focusLastOnNextOpen","open","dropdownEl","isActive","close","focusBackToTrigger","componentWillLoad","triggerEl","document","querySelector","triggerSelector","menuId","uniqueId","setTriggerRoles","addTriggerEventListeners","componentDidLoad","addMenuItemEventListeners","setAttribute","addEventListener","e","key","menuItemEls","Array","from","menuEl","querySelectorAll","length","forEach","item","preventDefault","focusMenuItem","dropdownItem","i","focusInControl","focusOutControl","handleDropdownOpened","handleDropdownClosed","handleItemSelected","persistent","render","width","dropdownProps","h","Object","assign","ref","el","noTriggerClickHandler","onOpened","onClosed","name","role","class","id"],"sources":["src/components/go-dropdown-menu/go-dropdown-menu.scss?tag=go-dropdown-menu","src/components/go-dropdown-menu/go-dropdown-menu.tsx"],"sourcesContent":["@import '../../global/scss/dropdown/mixins';\ngo-dropdown-menu {\n  /**\n    @prop --dd-item-gap:\n      Gap between dropdown items\n      - default: 0\n  */\n  --dd-item-gap: 0;\n\n  .dropdown-menu-inner {\n    display: flex;\n    flex-direction: column;\n    gap: var(--dd-item-gap);\n  }\n\n  @include dropdown-item-vars;\n\n  [role='menuitem'] {\n    @include dropdown-item;\n  }\n    \n  go-dropdown-item {\n    &[disabled] {\n      [role='menuitem'] {\n        @include item-disabled-state;\n      }\n    }\n  }\n}\n","import { Component, h, Element, Prop, Method, Listen } from '@stencil/core';\nimport { DropdownProps } from '../../interfaces';\nimport { uniqueId } from 'lodash-es';\n\n@Component({\n  tag: 'go-dropdown-menu',\n  styleUrl: 'go-dropdown-menu.scss',\n  shadow: false,\n})\nexport class GoDropdownMenu implements DropdownProps {\n  @Element() el: HTMLElement;\n\n  /**\n   * @see [go-dropdown](go-dropdown#props)\n   */\n  @Prop() triggerSelector: string;\n  /**\n   * keep track of active state\n   */\n  @Prop({ reflect: true, mutable: true }) isActive: boolean = false;\n\n  /**\n   * customise width of dropdown menu\n   */\n  @Prop() width?: string;\n\n  /**\n   * DOM id for menu\n   */\n  @Prop({ mutable: true })\n  menuId?: string;\n\n  /**\n   * If persistent, the dropdown will not close by itself on interaction with elements inside the menu.\n   */\n  @Prop() persistent? = false;\n\n  triggerEl: HTMLElement;\n  dropdownEl: HTMLGoDropdownElement;\n  menuEl: HTMLElement;\n  menuItemEls?: HTMLElement[];\n  focusedMenuItemIndex = 0;\n  focusLastOnNextOpen = false;\n  /**\n   * open menu\n   * @param focusFirst if auto focus on first item\n   */\n  @Method()\n  async open() {\n    if (!this.dropdownEl.isActive) {\n      // open menu and focus on first item\n      this.dropdownEl.open();\n    }\n  }\n\n  @Method()\n  async close(focusBackToTrigger = false) {\n    this.dropdownEl.close(focusBackToTrigger);\n  }\n\n  componentWillLoad() {\n    this.triggerEl = document.querySelector(this.triggerSelector);\n    if (!this.menuId) {\n      this.menuId = uniqueId('go-dropdown-menu-');\n    }\n\n    this.setTriggerRoles();\n    this.addTriggerEventListeners();\n  }\n\n  componentDidLoad() {\n    this.addMenuItemEventListeners();\n  }\n\n  setTriggerRoles() {\n    this.triggerEl.setAttribute('aria-controls', this.menuId);\n  }\n  addTriggerEventListeners() {\n    this.triggerEl.addEventListener('click', () => {\n      if (this.isActive) {\n        this.close();\n      } else {\n        this.open();\n      }\n    });\n    this.triggerEl.addEventListener('keydown', (e) => {\n      if (!this.dropdownEl) {\n        return;\n      }\n      const key = e.key;\n      if (key === 'ArrowUp') {\n        this.focusLastOnNextOpen = true;\n        this.open();\n      }\n      if (key === 'ArrowDown') {\n        this.open();\n      }\n    });\n  }\n\n  addMenuItemEventListeners() {\n    if (!this.menuItemEls) {\n      this.menuItemEls = Array.from(this.menuEl.querySelectorAll('go-dropdown-item'));\n    }\n    if (!this.menuItemEls.length) {\n      // no `go-dropdown-item` found\n      return;\n    }\n\n    // up down arrow keys move focus between menu items\n    this.menuItemEls.forEach((item) => {\n      item.addEventListener('keydown', (e) => {\n        if (e.key === 'Tab') {\n          this.close();\n        }\n        if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          this.focusedMenuItemIndex += 1;\n          if (this.focusedMenuItemIndex > this.menuItemEls.length - 1) {\n            this.focusedMenuItemIndex = 0;\n          }\n          this.focusMenuItem();\n        }\n\n        if (e.key === 'ArrowUp') {\n          e.preventDefault();\n          this.focusedMenuItemIndex -= 1;\n          if (this.focusedMenuItemIndex < 0) {\n            this.focusedMenuItemIndex = this.menuItemEls.length - 1;\n          }\n          this.focusMenuItem();\n        }\n      });\n    });\n  }\n\n  focusMenuItem() {\n    this.menuItemEls.forEach((dropdownItem: HTMLGoDropdownItemElement, i) => {\n      if (i === this.focusedMenuItemIndex) {\n        dropdownItem.focusInControl();\n      } else {\n        dropdownItem.focusOutControl();\n      }\n    });\n  }\n  handleDropdownOpened() {\n    this.isActive = true;\n    if (this.focusLastOnNextOpen) {\n      this.focusedMenuItemIndex = this.menuItemEls.length - 1;\n      this.focusLastOnNextOpen = false;\n    } else {\n      this.focusedMenuItemIndex = 0;\n    }\n\n    this.focusMenuItem();\n  }\n\n  handleDropdownClosed() {\n    this.isActive = false;\n  }\n\n  @Listen('selected')\n  handleItemSelected() {\n    if (!this.persistent) {\n      this.close();\n    }\n  }\n\n  render() {\n    const { triggerSelector, isActive, width, menuId } = this;\n    const dropdownProps = {\n      triggerSelector,\n      isActive,\n      width,\n    };\n    return (\n      <go-dropdown\n        ref={(el) => {\n          this.dropdownEl = el;\n        }}\n        noTriggerClickHandler={true}\n        onOpened={() => this.handleDropdownOpened()}\n        onClosed={() => this.handleDropdownClosed()}\n        {...dropdownProps}>\n        <slot name=\"prefix\"></slot>\n        <div\n          role=\"menu\"\n          class=\"dropdown-menu-inner\"\n          id={menuId}\n          ref={(el) => {\n            this.menuEl = el;\n          }}>\n          <slot></slot>\n        </div>\n        <slot name=\"suffix\"></slot>\n      </go-dropdown>\n    );\n  }\n}\n"],"mappings":"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"}